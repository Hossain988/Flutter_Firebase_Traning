# Smart Notes App - Firebase Tutorial Project

A comprehensive Flutter notes app built with Provider for state management. This project is designed to teach Firebase Firestore operations, including CRUD operations, queries, filtering, and composite indexes.

## ğŸ¯ Learning Objectives

Students will learn:
- **Authentication**: User signup, login, logout with Firebase Auth
- **User Data Management**: Storing additional user info in Firestore
- **CRUD Operations**: Create, Read, Update, Delete notes
- **Array Queries**: Using `arrayContains` for tags
- **Boolean Queries**: Filtering by pinned status
- **String/Enum Queries**: Filtering by category and priority
- **Range Queries**: Date-based filtering (recent/old notes)
- **Composite Indexes**: Understanding when and why they're needed
- **Client-side Filtering**: Search functionality
- **Data Modeling**: Structuring Firestore documents

## ğŸ“‹ Project Structure

```
lib/
â”œâ”€â”€ main.dart                 # App entry point with Provider setup & auth routing
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ note.dart            # Note data model (TODO: implement toMap/fromMap)
â”‚   â””â”€â”€ user_model.dart      # User data model with additional fields
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ firebase_service.dart # Firebase Firestore operations (TODO: implement)
â”‚   â””â”€â”€ auth_service.dart    # Firebase Auth operations (TODO: implement)
â”œâ”€â”€ providers/
â”‚   â”œâ”€â”€ notes_provider.dart  # Notes state management with Provider
â”‚   â””â”€â”€ auth_provider.dart   # Authentication state management
â”œâ”€â”€ screens/
â”‚   â”œâ”€â”€ home_screen.dart     # Main screen with notes list and filters
â”‚   â”œâ”€â”€ login_screen.dart    # User login screen
â”‚   â”œâ”€â”€ signup_screen.dart   # User registration with additional info
â”‚   â””â”€â”€ add_edit_note_screen.dart # Create/edit note screen
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ note_card.dart       # Individual note card widget
â”‚   â””â”€â”€ filter_chips.dart    # Filter UI components
â””â”€â”€ utils/
    â””â”€â”€ constants.dart       # App constants (categories, priorities, etc.)
```

## ğŸš€ Setup Instructions

### 1. Install Dependencies

```bash
flutter pub get
```

### 2. Configure Firebase

#### Option A: Using FlutterFire CLI (Recommended)

1. Install FlutterFire CLI:
```bash
dart pub global activate flutterfire_cli
```

2. Create a Firebase project at [Firebase Console](https://console.firebase.google.com/)

3. Configure Firebase for your Flutter app:
```bash
flutterfire configure
```

4. When prompted:
   - Select your Firebase project
   - Select platforms (Android, iOS, Web, etc.)
   - **Select Flutter** when asked about the app type
   - The CLI will automatically download and configure all necessary files

#### Option B: Using Firebase CLI

1. Install Firebase CLI:
```bash
npm install -g firebase-tools
```

2. Login to Firebase:
```bash
firebase login
```

3. Initialize Firebase in your project:
```bash
firebase init
```

4. When prompted:
   - Select **Flutter** as your app type
   - Select your Firebase project
   - The CLI will configure your project automatically

### 3. Uncomment Firebase Dependencies

In `pubspec.yaml`, uncomment:
```yaml
cloud_firestore: ^5.4.0
firebase_auth: ^5.0.0
firebase_core: ^3.6.0
```

Then run:
```bash
flutter pub get
```

### 4. Initialize Firebase

In `lib/main.dart`, add Firebase initialization:
```dart
import 'package:firebase_core/firebase_core.dart';
import 'firebase_options.dart'; // Generated by FlutterFire CLI

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  runApp(const MyApp());
}
```

**Note:** The `firebase_options.dart` file is automatically generated by FlutterFire CLI and contains platform-specific Firebase configuration.

## ğŸ“ Implementation Tasks

### Task 1: User Model (`lib/models/user_model.dart`)
- [ ] Implement `toMap()` method to convert UserModel to Firestore Map
- [ ] Implement `fromMap()` factory constructor to parse Firestore data
- [ ] Handle Timestamp â†” DateTime conversions
- [ ] Handle optional fields (photoUrl, bio, address, lastLoginAt)

### Task 2: Auth Service (`lib/services/auth_service.dart`)
- [ ] Initialize Firebase Auth instance
- [ ] Initialize Firestore instance
- [ ] Implement `getCurrentUser()` - Get current authenticated user
- [ ] Implement `authStateChanges` stream - Listen to auth state changes
- [ ] Implement `signUp()` - Create user with email/password and store additional info in Firestore
- [ ] Implement `signIn()` - Sign in user and update lastLoginAt
- [ ] Implement `signOut()` - Sign out current user
- [ ] Implement `updateProfile()` - Update user profile in Firestore
- [ ] Implement `sendPasswordResetEmail()` - Send password reset email

### Task 3: Auth Provider (`lib/providers/auth_provider.dart`)
- [ ] Implement `_initAuthListener()` - Listen to auth state changes
- [ ] Call AuthService methods in `signUp()`
- [ ] Call AuthService methods in `signIn()`
- [ ] Call AuthService methods in `signOut()`
- [ ] Call AuthService methods in `updateProfile()`
- [ ] Call AuthService methods in `sendPasswordResetEmail()`

### Task 4: Note Model (`lib/models/note.dart`)
- [ ] Implement `toMap()` method to convert Note to Firestore Map
- [ ] Implement `fromMap()` factory constructor to parse Firestore data
- [ ] Handle Timestamp â†” DateTime conversions
- [ ] Handle optional `reminderDate` field

### Task 5: Firebase Service (`lib/services/firebase_service.dart`)
- [ ] Initialize Firestore instance
- [ ] Get current user ID from Firebase Auth
- [ ] Implement `createNote()` - Add note to Firestore
- [ ] Implement `getAllNotes()` - Query with composite orderBy (pinned + createdAt)
- [ ] Implement `getNotesByCategory()` - Filter by category
- [ ] Implement `getNotesByTag()` - Use `arrayContains` query
- [ ] Implement `getNotesByPriority()` - Filter by priority
- [ ] Implement `getPinnedNotes()` - Filter by pinned status
- [ ] Implement `getRecentNotes()` - Range query with `isGreaterThan`
- [ ] Implement `getOldNotes()` - Range query with `isLessThan`
- [ ] Implement `getNotesWithReminders()` - Query with `isNotEqualTo: null`
- [ ] Implement `searchNotesByTitle()` - Client-side or server-side search
- [ ] Implement `searchNotesByBody()` - Client-side filtering
- [ ] Implement `updateNote()` - Update existing note
- [ ] Implement `deleteNote()` - Delete note
- [ ] Implement `togglePinned()` - Partial update

### Task 6: Notes Provider (`lib/providers/notes_provider.dart`)
- [ ] Call FirebaseService methods in `loadNotes()`
- [ ] Call FirebaseService methods in `createNote()`
- [ ] Call FirebaseService methods in `updateNote()`
- [ ] Call FirebaseService methods in `deleteNote()`
- [ ] Call FirebaseService methods in `togglePinned()`
- [ ] Implement `_applyFilters()` - Apply category, priority, tag, date, and search filters

### Task 7: Auth State Routing (`lib/main.dart`)
- [ ] Update `AuthWrapper` to check `authProvider.isAuthenticated`
- [ ] Route to `HomeScreen` if authenticated
- [ ] Route to `LoginScreen` if not authenticated

## ğŸ”¥ Firestore Rules

Create Firestore security rules:
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Users collection - users can only read/write their own data
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Notes collection - users can only read/write their own notes
    match /notes/{noteId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.uid;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.uid;
    }
  }
}
```

## ğŸ“Š Required Composite Indexes

Firestore will prompt you to create these indexes when you run queries:

1. **Pinned + CreatedAt Index**
   - Collection: `notes`
   - Fields: `pinned` (Descending), `createdAt` (Descending)
   - Query: `where('uid', isEqualTo: userId).orderBy('pinned').orderBy('createdAt')`

2. **Category + CreatedAt Index**
   - Collection: `notes`
   - Fields: `category` (Ascending), `createdAt` (Descending)
   - Query: `where('category', isEqualTo: category).orderBy('createdAt')`

## ğŸ¨ Features

### Authentication
- âœ… User registration with email/password
- âœ… User login and logout
- âœ… Password reset functionality
- âœ… Store additional user information (name, phone, bio, address, date of birth)
- âœ… User profile management

### Notes Management
- âœ… Create, edit, and delete notes
- âœ… Categorize notes (Work, Personal, Ideas, etc.)
- âœ… Add tags to notes
- âœ… Pin important notes
- âœ… Set priority levels (Low, Medium, High)
- âœ… Set reminders for notes
- âœ… Filter by category, priority, tags, and date
- âœ… Search notes by title or body
- âœ… Beautiful Material Design 3 UI

## ğŸ“š Data Models

### User Model (stored in `users` collection)
```dart
UserModel {
  uid: string (Firebase Auth UID)
  email: string
  displayName: string
  photoUrl: string? (optional)
  firstName: string
  lastName: string
  phoneNumber: string
  bio: string? (optional)
  dateOfBirth: Timestamp
  address: string? (optional)
  createdAt: Timestamp
  lastLoginAt: Timestamp? (optional)
}
```

### Note Model (stored in `notes` collection)
```dart
Note {
  noteId: string
  uid: string (user ID - links to users collection)
  title: string
  body: string
  category: string (Work, Personal, Ideas, etc.)
  tags: List<String> (['urgent', 'meeting', etc.])
  pinned: bool
  priority: string ('low', 'medium', 'high')
  createdAt: Timestamp
  reminderDate: Timestamp? (optional)
}
```

## ğŸ› Troubleshooting

### "Index required" Error
- Firestore will provide a link to create the required index
- Click the link and create the index in Firebase Console
- Wait a few minutes for the index to build

### "Permission denied" Error
- Check Firestore security rules
- Ensure user is authenticated
- Verify `uid` matches current user

### Notes not loading
- Check Firebase initialization
- Verify Firestore rules allow read access
- Check console for error messages

## ğŸ“– Resources

- [Firestore Documentation](https://firebase.google.com/docs/firestore)
- [FlutterFire Documentation](https://firebase.flutter.dev/)
- [Provider Package](https://pub.dev/packages/provider)

## ğŸ“ Next Steps

After completing the basic implementation:
1. Add user authentication UI
2. Implement real-time listeners (snapshots)
3. Add note sharing functionality
4. Implement note export (PDF, text)
5. Add dark mode support
6. Implement local caching with offline support

---

**Happy Coding! ğŸš€**
